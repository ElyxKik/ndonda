================================================================================
ğŸ” GUIDE - RECHERCHE INTELLIGENTE AVEC LEVENSHTEIN
================================================================================

## ğŸ“‹ RÃ‰SUMÃ‰

Le systÃ¨me d'IA utilise maintenant l'algorithme de Levenshtein pour une recherche
intelligente et flexible dans plusieurs collections Firestore.

================================================================================
ğŸ§  COMMENT Ã‡A MARCHE
================================================================================

### Ã‰tape 1: Extraction de la requÃªte
L'utilisateur pose une question:
"Peux-tu me parler du projet PDL145 Ã  Ngandajika?"

### Ã‰tape 2: Recherche intelligente
Le systÃ¨me recherche dans TOUTES les collections:
- projects
- entreprises
- ministeres

Pour chaque document, il calcule un SCORE DE SIMILARITÃ‰ basÃ© sur:
1. Distance de Levenshtein (tolÃ©rance aux fautes de frappe)
2. Correspondance exacte (bonus)
3. Poids des champs (nom > localisation > description)

### Ã‰tape 3: Tri et sÃ©lection
- Trier par score dÃ©croissant
- Garder les 5 meilleurs rÃ©sultats
- Filtrer ceux avec score >= 0.25

### Ã‰tape 4: Formatage lisible
Convertir les donnÃ©es en texte naturel (PAS de JSON)

### Ã‰tape 5: Envoi Ã  Gemini
Gemini gÃ©nÃ¨re une rÃ©ponse conversationnelle

================================================================================
ğŸ¯ ALGORITHME DE LEVENSHTEIN
================================================================================

La distance de Levenshtein mesure le nombre de modifications nÃ©cessaires pour
transformer une chaÃ®ne en une autre.

EXEMPLES:
- "pdl145" vs "PDL145" = 0 (aprÃ¨s normalisation)
- "ngandajika" vs "ngandajika" = 0 (exact match)
- "ngandajika" vs "ngandajika" = 0 (exact match)
- "kinshasa" vs "kinshassa" = 1 (1 insertion)
- "infrastructure" vs "infrastruktur" = 2 (2 substitutions)

SCORE DE SIMILARITÃ‰:
score = 1.0 - (distance / max_length)

Exemple:
- distance = 2, max_length = 14
- score = 1.0 - (2/14) = 0.857 âœ… PERTINENT

================================================================================
ğŸ“Š SYSTÃˆME DE POIDS
================================================================================

Chaque champ a un poids pour la pertinence:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Champ           â”‚ Poids  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ nom             â”‚ 1.0    â”‚ (le plus important)
â”‚ localisation    â”‚ 0.9    â”‚
â”‚ maitre_oeuvre   â”‚ 0.8    â”‚
â”‚ maitre_ouvrage  â”‚ 0.8    â”‚
â”‚ entreprises     â”‚ 0.7    â”‚
â”‚ description     â”‚ 0.6    â”‚ (moins important)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜

CALCUL DU SCORE:
1. Pour chaque champ:
   - Si match exact: score += 1.0 * poids
   - Sinon: score += similaritÃ© * poids

2. Bonus collection:
   - Si collection match: score += 1.2
   - Sinon: score += similaritÃ© * 0.8

3. Score final:
   score_final = score_total / (nombre_champs + 1)

================================================================================
ğŸ”§ EXEMPLE CONCRET
================================================================================

QUESTION: "Peux-tu me parler du projet PDL145 Ã  Ngandajika?"

DOCUMENT FIRESTORE:
{
  "nom": "PDL145 TERRITOIRE",
  "localisation": "Ngandajika",
  "maitre_oeuvre": "Min Infrastructure",
  "montant": 500000,
  "delai": "25 mois"
}

CALCUL DU SCORE:
1. nom: "pdl145" vs "pdl145 territoire"
   - Match partiel: score += 0.8 * 1.0 = 0.8

2. localisation: "ngandajika" vs "ngandajika"
   - Match exact: score += 1.0 * 0.9 = 0.9

3. maitre_oeuvre: "pdl145" vs "min infrastructure"
   - Pas de match: score += 0.0

4. Collection: "projects" vs "pdl145"
   - Pas de match: score += 0.0

SCORE FINAL: (0.8 + 0.9 + 0 + 0) / 7 = 0.24 âŒ SOUS LE SEUIL

MAIS AVEC BONUS:
Si on ajoute la localisation: 0.24 + 0.9 = 1.14 âœ… PERTINENT

================================================================================
âš™ï¸ CONFIGURATION
================================================================================

### Collections Ã  rechercher (dans firebase_gemini_service.dart):
```dart
static const List<String> COLLECTIONS = ['projects', 'entreprises', 'ministeres'];
```

### Seuil de pertinence:
```dart
if (score >= 0.25) {
  // Garder ce rÃ©sultat
}
```

### Nombre de rÃ©sultats:
```dart
final results = allResults.take(5).toList(); // Top 5
```

================================================================================
ğŸ§ª TESTER LE SYSTÃˆME
================================================================================

1. Ouvrez l'application
2. Allez au menu "IA - DonnÃ©es Firebase"
3. Posez une question avec des mots-clÃ©s
4. VÃ©rifiez les logs pour voir:
   - Les documents trouvÃ©s
   - Les scores de similaritÃ©
   - Le contexte envoyÃ© Ã  Gemini

EXEMPLES DE QUESTIONS:
âœ… "Peux-tu me parler du projet PDL145?"
âœ… "Quels projets Ã  Ngandajika?"
âœ… "Qui est le maÃ®tre d'Å“uvre du projet infrastructure?"
âœ… "Parle-moi de la SARL Construction Plus"
âœ… "Quels projets du MinistÃ¨re des Infrastructures?"

================================================================================
ğŸ“Š RÃ‰SULTAT ATTENDU
================================================================================

QUESTION: "Peux-tu me parler du projet PDL145 Ã  Ngandajika?"

LOGS:
âœ“ RÃ©sultats de recherche: 1 document
âœ“ Score: 0.95 (trÃ¨s pertinent)
âœ“ Collection: projects
âœ“ Contexte construit avec 1 document

RÃ‰PONSE GEMINI:
"Le projet PDL145 Territoire, situÃ© Ã  Ngandajika, est supervisÃ© par le 
MinistÃ¨re des Infrastructures. Il s'agit d'un programme d'amÃ©nagement 
territorial financÃ© Ã  hauteur d'environ 500 000 USD, avec une durÃ©e prÃ©vue 
de 25 mois."

================================================================================
âš ï¸ DÃ‰PANNAGE
================================================================================

âŒ PROBLÃˆME: "Je n'ai pas cette information"
âœ… SOLUTION: 
   - VÃ©rifiez que les documents existent dans Firestore
   - VÃ©rifiez les scores dans les logs
   - Augmentez le seuil de pertinence si nÃ©cessaire

âŒ PROBLÃˆME: Mauvais documents trouvÃ©s
âœ… SOLUTION:
   - Ajustez les poids des champs
   - Augmentez le seuil de pertinence (0.25 â†’ 0.35)
   - VÃ©rifiez les donnÃ©es dans Firestore

âŒ PROBLÃˆME: Aucun rÃ©sultat
âœ… SOLUTION:
   - Les mots-clÃ©s ne correspondent pas
   - VÃ©rifiez l'orthographe
   - Essayez une question plus simple

================================================================================
ğŸš€ OPTIMISATIONS POSSIBLES
================================================================================

1. **Indexation Firestore**: CrÃ©er des index pour les recherches rapides
2. **Cache**: MÃ©moriser les rÃ©sultats frÃ©quents
3. **Fuzzy matching**: AmÃ©liorer la tolÃ©rance aux fautes
4. **Multi-langue**: Supporter plusieurs langues
5. **Filtres**: Ajouter des filtres par date, montant, etc.

================================================================================
